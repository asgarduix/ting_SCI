<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>華南產物保險-FBBP0100-暫收(付)報表列印作業</title>
    <!-- favicon -->
    <link rel="shortcut icon" href="img/favicon.ico">
    <!-- jQuery-ui -->
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/jquery-ui.theme.css">
    <!-- Bootstrap_4.5.2 -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- material_icon -->
    <link rel="stylesheet" href="css/material-icons.css">
    <link rel="stylesheet" href="css/material-icons-ie.css">
    <!-- tabulator_4.9 -->
    <link rel="stylesheet" href="css/tabulator.min.css">
    <!-- 全域 -->
    <link rel="stylesheet" href="css/global.css">
    <!-- 框架 -->
    <link rel="stylesheet" href="css/layout.css">
    <!-- 頁面 -->
    <link rel="stylesheet" href="css/page.css">
    <!-- pg使用 -->
    <link rel="stylesheet" href="css/pg.css">
</head>

<body id="canvas" class="fbcm0150-01">
    <div class="frame">
        <!-- frame: menu -->
        <nav class="frame-block leftBlock" id="left_menu">
            <div class="leftBlock-inner mCustomScrollbar">
                <!-- menu-logo -->
                <div class="frame-logo">
                    <a href="#"><img src="img/logo-w.svg" alt=""></a>
                </div>
                <div class="frame-menu">
                    <!-- menu-filter -->
                    <div class="menu-filter">
                        <input type="text" id="menu_filter" placeholder="搜尋目錄">
                    </div>
                    <div class="menu-pgName"><span>應收系統</span></div>
                    <div class="menu-list">
                        <ul>
                            <li>
                                <a href="fbbi0001-query.html">
                                    <span>FBBI0001</span>
                                    <span>暫收款查詢作業</span>
                                </a>
                            </li>
                            <li>
                                <a href="fbbm0400-query.html">
                                    <span>FBBM0400</span>
                                    <span>暫收整批維護作業</span>
                                </a>
                            </li>
                            <li>
                                <a href="fbbm0100-sub_tab01-query.html">
                                    <span>FBBM0100</span>
                                    <span>暫收單筆建檔維護作業</span>
                                </a>
                            </li>
                            <li>
                                <a href="fbbp0100-01-query.html" class="menu-list-active">
                                    <span>FBBP0100</span>
                                    <span>暫收(付)報表列印作業</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
        <!-- frame: content -->
        <div class="frame-block rightBlock" id="right_content">
            <!-- header -->
            <header class="frame-content headerModule">
                <div class="headerModule-inner">
                    <div class="header-item header-title">
                        <div class="menu-btn">
                            <a href="javascript:;" onclick="menuToggle()" class="menu-active"><span class="menu-bar"></span></a>
                        </div>
                        <div class="header-unit">
                            <div class="header-unit-inner">
                                <div class="header-unit-item header-unit-finance">
                                    <a href="#" title="財務">財務</a>
                                    <ul>
                                        <li><a href="#">應收系統</a></li>
                                        <li><a href="#">銷帳系統</a></li>
                                        <li><a href="#">應付系統</a></li>
                                        <li><a href="#">催收系統</a></li>
                                        <li><a href="#">銀資系統</a></li>
                                        <li><a href="#">查詢系統</a></li>
                                        <li><a href="#">統計系統</a></li>
                                        <li><a href="#">分析系統</a></li>
                                    </ul>
                                </div>
                                <div class="header-unit-item header-unit-invest">
                                    <a href="#" title="投資">投資</a>
                                </div>
                                <div class="header-unit-item header-unit-accounting">
                                    <a href="#" title="會計">會計</a>
                                </div>
                                <div class="header-unit-item header-unit-report">
                                    <a href="#" title="報表">報表</a>
                                </div>
                                <div class="header-unit-item header-unit-public">
                                    <a href="#" title="公用">公用</a>
                                </div>
                                <div class="header-unit-item header-unit-manage">
                                    <a href="#" title="管理">管理</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="header-item header-info">
                        <ul>
                            <li class="header-info-home"><a href="#"><span class="material-icons">home</span></a></li>
                            <li class="header-info-identity">
                                <select>
                                    <option>財務管理：陳怡芳(ABC12345)</option>
                                    <option>銀資管理：陳怡芳(ABC12345)</option>
                                </select>
                            </li>
                            <li class="header-info-time"><span>time</span></li>
                            <li class="header-info-logout"><a href="javascript:;">登出</a></li>
                        </ul>
                    </div>
            </header>
            <!-- main -->
            <main class="frame-content mainModule">
                <div class="content">
                    <!-- breadcrumb -->
                    <div class="content-component content-breadcrumb">
                        <ul>
                            <li><a href="#">財務</a></li>
                            <li><a href="#">暫收款管理</a></li>
                            <li><a href="#">暫收(付)報表列印作業</a></li>
                        </ul>
                    </div>
                    <!-- card -->
                    <div class="content-component content-card">
                        <!-- unitname -->
                        <div class="content-component content-unitname">
                            <div class="unitname-inner">
                                <div class="unitname-item unitname-title">暫收(付)報表列印作業</div>
                                <div class="unitname-item unitname-favourite">
                                    <a href="#" data-toggle="tooltip" title="加入我的最愛" data-placement="left"><span class="material-icons">star_outline</span></a>
                                </div>
                            </div>
                        </div>
                        <!-- query -->
                        <div class="card-detail">
                            <!-- card-detail >> board -->
                            <div class="detail-board detail-board-query">
                                <!-- query -->
                                <div class="content-component content-query">
                                    <div class="query-row">
                                        <div class="query-field query-input">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">單位</div>
                                                <div class="query-field-item query-field-entry">
                                                    <input type="text" name="單位" value="" title="" data-toggle="tooltip" data-placement="top">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="query-field query-input">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">列印種類</div>
                                                <div class="query-field-item query-field-entry">
                                                    <div class="entry-inner">
                                                        <div class="entry-combine entry-4">
                                                            <input type="text" name="列印種類" value="" title="" data-toggle="tooltip" data-placement="top">
                                                        </div>
                                                        <div class="entry-combine entry-6">
                                                            <select>
                                                                <option>建檔</option>
                                                                <option >未銷帳</option>
                                                                <option >已銷帳</option>
                                                                <option selected>已銷帳(退款明細)</option>
                                                                <option>總表</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="query-field query-input">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">統計日期</div>
                                                <div class="query-field-item query-field-entry">
                                                    <div class="entry-inner">
                                                        <div class="entry-combine entry-4">
                                                            <input type="date" name="統計日期起日" value="" title="" data-toggle="tooltip" data-placement="top">
                                                        </div>
                                                        <div class="entry-combine entry-1">～</div>
                                                        <div class="entry-combine entry-4">
                                                            <input type="date" name="統計日期訖日" data-toggle="tooltip" data-placement="top">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="query-row">
                                        
                                        <div class="query-field query-input">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">銷帳類別</div>
                                                <div class="query-field-item query-field-entry">
                                                    <select>
                                                        <option></option>
                                                        <option></option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        
                                    </div>
                                    <div class="query-row">
                                        <div class="query-field query-input query-input-half">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">列印對象</div>
                                                <div class="query-field-item query-field-entry">
                                                    <ul>
                                                        <li><input type="radio" id="rd01" name="對象代號"><label for="rd01">暫收人員</label></li>
                                                        <li><input type="radio" id="rd02" name="對象代號"><label for="rd02">保代</label></li>
                                                        <li><input type="radio" id="rd03" name="對象代號"><label for="rd03">繳款人</label></li>
                                                        <li><input type="radio" id="rd04" name="對象代號"><label for="rd04">經手人</label></li>
                                                        <li><input type="radio" id="rd05" name="對象代號"><label for="rd05">入帳人員</label></li>
                                                        <li><input type="radio" id="rd06" name="對象代號"><label for="rd06">客戶ID</label></li>
                                                        <li><input type="radio" id="rd07" name="對象代號"><label for="rd07">統編</label></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="query-field query-input">
                                            <div class="query-field-inner">
                                                <div class="query-field-item query-field-title">對象代號</div>
                                                <div class="query-field-item query-field-entry">
                                                    <div class="entry-inner">
                                                        <div class="entry-combine entry-3">
                                                            <select>
                                                                <option></option>
                                                                <option></option>
                                                                <option></option>
                                                            </select>
                                                        </div>
                                                        <div class="entry-combine entry-7">
                                                            <input type="text" disabled="" name="暫收名稱" attr="" value="暫收名稱" title="暫收名稱" data-toggle="tooltip" data-placement="top">
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- button -->
                        <div class="card-detail">
                            <!-- card-detail >> board -->
                            <div class="detail-board detail-board-btn">
                                <!-- btn -->
                                <div class="content-component content-btn">
                                    <div class="content-btn-main">
                                        <ul>
                                            <li><button class="content-btn-item btn-main btn-clear"><span>清除</span></button></li>
                                        </ul>
                                    </div>
                                    <div class="content-btn-secondary">
                                        <ul>
                                            <li><button class="content-btn-item btn-secondary btn-print"><span>列印</span></button></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- copyright -->
                        <div class="content-component content-copyright">[ V-1.0.1 ] ©2021 華南產物保險</div>
                    </div>
                </div>
                <div class="aside">
                    <div class="aside-item">
                        <a href="javascript:;" onclick="asideToggle('aside_func1');" class="aside-btn" data-toggle="tooltip" title="待辦事項" data-placement="left"><span class="material-icons">mail_outline</span></a>
                        <!-- 待辦事項 -->
                        <div class="aside-group" id="aside_func1" style="display: none;">
                            <div class="aside-group-header">
                                <div class="group-header-inner">
                                    <div class="group-header-item group-header-title" title="待辦事項">待辦事項</div>
                                    <div class="group-header-item group-header-btn" title="重整"><button>重整</button></div>
                                </div>
                            </div>
                            <div class="aside-group-list list-todo">
                                <div class="todo-component">
                                    <div class="todo-header">
                                        <div class="todo-header-inner">
                                            <div class="todo-title">出納<span>3</span></div>
                                            <div class="todo-btn"><a href="#"><span class="material-icons">arrow_drop_down</span></a></div>
                                        </div>
                                    </div>
                                    <div class="todo-content">
                                        <div class="todo-content-item">
                                            <div class="todo-date">2021/11/16</div>
                                            <div class="todo-link">
                                                <ul>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="todo-content-item">
                                            <div class="todo-date">2021/11/16</div>
                                            <div class="todo-link">
                                                <ul>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="todo-component">
                                    <div class="todo-header">
                                        <div class="todo-header-inner">
                                            <div class="todo-title">出納<span>3</span></div>
                                            <div class="todo-btn"><a href="#"><span class="material-icons">arrow_drop_down</span></a></div>
                                        </div>
                                    </div>
                                    <div class="todo-content">
                                        <div class="todo-content-item">
                                            <div class="todo-date">2021/11/16</div>
                                            <div class="todo-link">
                                                <ul>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="todo-content-item">
                                            <div class="todo-date">2021/11/16</div>
                                            <div class="todo-link">
                                                <ul>
                                                    <li><a href=""><span>ABCD123456</span><span>保費科項目名稱</span></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="aside-item">
                        <a href="javascript:;" onclick="asideToggle('aside_func2')" class="aside-btn" data-toggle="tooltip" title="常用程式" data-placement="left"><span class="material-icons">grade</span></a>
                        <!-- 常用程式 -->
                        <div class="aside-group" id="aside_func2" style="display: none;">
                            <div class="aside-group-header">
                                <div class="group-header-inner">
                                    <div class="group-header-item group-header-title" title="常用程式">常用程式</div>
                                    <div class="group-header-item group-header-btn" title="編輯"><button>編輯</button></div>
                                </div>
                            </div>
                            <div class="aside-group-list list-favorite">
                                <ul>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a></li>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a></li>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a><span class="material-icons favorite-remove">close</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="aside-item">
                        <a href="javascript:;" onclick="asideToggle('aside_func3')" class="aside-btn" data-toggle="tooltip" title="操作手冊" data-placement="left"><span class="material-icons">source</span></a>
                        <!-- 操作手冊 -->
                        <div class="aside-group" id="aside_func3" style="display: none;">
                            <div class="aside-group-header">
                                <div class="group-header-inner">
                                    <div class="group-header-item group-header-title" title="操作手冊">操作手冊</div>
                                </div>
                            </div>
                            <div class="aside-group-list list-Operation">
                                <ul>
                                    <li><a href="#">財務通告</a></li>
                                    <li><a href="#">財務QA</a></li>
                                    <li><a href="#">常用表單</a></li>
                                    <li><a href="#">操作手冊</a></li>
                                    <li><a href="#">法令規範</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="aside-item">
                        <a href="javascript:;" onclick="asideToggle('aside_func4')" class="aside-btn" data-toggle="tooltip" title="瀏覽紀錄" data-placement="left"><span class="material-icons">save</span></a>
                        <!-- 瀏覽紀錄 -->
                        <div class="aside-group" id="aside_func4" style="display: none;">
                            <div class="aside-group-header">
                                <div class="group-header-inner">
                                    <div class="group-header-item group-header-title" title="瀏覽紀錄">瀏覽紀錄</div>
                                    <div class="group-header-item group-header-btn"><button>清除</button></div>
                                </div>
                            </div>
                            <div class="aside-group-list list-history">
                                <div class="aside-group-note">
                                    <p>點擊「清除」後將刪除所有暫存資料</p>
                                </div>
                                <ul>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a><span class="material-icons history-remove">close</span></li>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a><span class="material-icons history-remove">close</span></li>
                                    <li><a href="#"><span>FACM0200</span><span>信用卡入帳維護</span></a><span class="material-icons history-remove">close</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="aside-item">
                        <a href="javascript:;" onclick="asideToggle('aside_func5')" class="aside-btn" data-toggle="tooltip" title="使用者設定" data-placement="left"><span class="material-icons">settings</span></a>
                        <!-- 使用者設定 -->
                        <div class="aside-group" id="aside_func5" style="display: none;">
                            <div class="aside-group-header">
                                <div class="group-header-inner">
                                    <div class="group-header-item group-header-title" title="使用者設定">使用者設定</div>
                                </div>
                            </div>
                            <div class="aside-group-list list-setting">
                                <div class="setting-item">
                                    <div class="setting-item-inner">
                                        <div class="setting-title">深色模式</div>
                                        <div class="setting-btn"><span class="material-icons">toggle_off</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <!-- popup -->
</body>
<!-- jQuery_3.5.1  -->
<script src="js/jquery-3.5.1.min.js"></script>
<!-- jQuery-ui_1.12.1 -->
<script src="js/jquery-ui.js"></script>
<!-- Popper -->
<script src="js/popper.min.js"></script>
<!-- Bootstrap_4.5.2 -->
<script src="js/bootstrap.min.js"></script>
<!-- tabulator_4.9 -->
<script src="js/tabulator.min.js"></script>
<!-- tabulator_json -->
<!-- <script src="json/table01.js"></script> -->
<!-- 自定義js -->
<script src="js/layout.js"></script>
<!-- pg使用 -->
<script src="js/pg.js"></script>
<script>
    //測試資料
    let nestedData = [
        {
            id: 1, make: "Ford", model: "focus", reg: "P232 NJP", color: "white", serviceHistory: [
                { date: "01/02/2016", engineer: "Steve Boberson", actions: "Changed oli filter" },
                { date: "07/02/2017", engineer: "Martin Stevenson", actions: "Break light broken" },
            ]
        },
        {
            id: 2, make: "BMW", model: "m3", reg: "W342 SEF", color: "red", serviceHistory: [
                { date: "22/05/2017", engineer: "Jimmy Brown", actions: "Aligned wheels" },
                { date: "11/02/2018", engineer: "Lotty Ferberson", actions: "Changed Oil" },
                { date: "04/04/2018", engineer: "Franco Martinez", actions: "Fixed Tracking" },
            ]
        },
    ]

    var table = new Tabulator("#table1", {
        height: "100%",
        layout: "fitColumns",
        movableColumns: true,
        data: nestedData,
        columns: [
            {
                title: "開合按紐",
                formatter: (cell, formatterParams, onRendered) => {
                    let div = document.createElement('div');
                    let el = cell.getRow().getElement()
                    let btnName = ["＋", "–"]

                    btnName.forEach((name, index) => {
                        let btn = document.createElement('button');
                        $(btn).text(name)
                        elementsChangeClass(btn, "add", "table-btn-switch")
                        btn.addEventListener("click", (e) => {
                            $(el).find(".table-btn-switch").toggle()
                            $(el).find(".table-subtable-container").toggle()
                        });
                        if (index === 1) {
                            $(btn).css("display", "none")
                        }
                        div.appendChild(btn)
                    })
                    return div
                },
                headerHozAlign: "center",
                hozAlign: "center",
                headerSort: false
            },
            { title: "銀行名稱", field: "make" },
            { title: "總筆數", field: "model" },
            { title: "金額", field: "reg" },
            // { title: "Color", field: "color" },
        ],
        rowFormatter: function (row) {
            let container = document.createElement("div");
            let subtable = document.createElement("div");

            $(container).css("display", "none")
            elementsChangeClass(container, "add", "table-subtable-container")
            elementsChangeClass(subtable, "add", "table-subtable")
            $(subtable).attr("id",row.getData().make)

            container.appendChild(subtable);
            row.getElement().appendChild(container);

            let subTable = new Tabulator("#"+row.getData().make, {
                layout: "fitColumns",
                data: row.getData().serviceHistory,
                columns: [
                    { title: "銀行名稱", field: "date", sorter: "date" },
                    { title: "總筆數", field: "engineer" },
                    { title: "金額", field: "actions" },
                ]
            })
        },
    });


    function elementsChangeClass(elements, behavior, classNames) {
        // 使用方式
        // elements: 可接受格式 
        //      1. "#add, #edit, #del"  // CSS selector字串
        //      2. $("#add, #edit, #del")   // jQuery格式元素
        //      3. document.querySelectorAll("#add, #edit, #del")   // 原生javascript格式元素
        // behavior: "add" or "remove"
        // classNames: "btn-hide otherclass1 otherclass2" 中間以空白間隔

        if (behavior === "add") {
            $(elements).each(function (index, element) {
                $(element).addClass(classNames)
            })
        } else if (behavior === "remove") {
            $(elements).each(function (index, element) {
                $(element).removeClass(classNames)
            })
        }
    }
</script>
<script>
    var table2Data = [{
        checkbox: "checkbox",
        序號: "設計文字",
        幣別: "設計文字",
        原幣金額: "設計文字",
        兌換損益: "設計文字",
        金額: "設計文字",
        支付方式: "設計文字",
        付款單位: "設計文字",
        電匯銀行代號: "設計文字",
        電匯銀行名稱: "設計文字",
        退回維護日: "設計文字",
        郵寄日: "設計文字",
        票據兌現日: "設計文字",
        票據轉雜收日: "設計文字",
        帳號票號: "設計文字",
        郵匯費: "設計文字",
        支付對象ID: "設計文字",
        支付對象: "設計文字",
        地址: "設計文字",
        無法清理之樣態: "設計文字",
        銀行退回手續費: "設計文字",
        付款行: "設計文字",
        付款帳號: "設計文字",
        更新日期: "設計文字",
        建檔日期: "設計文字",
        操作人員: "設計文字",
        新暫收號: "設計文字",
        新暫收日: "設計文字",
        新暫收序號: "設計文字"
    }, ]
    var table2 = new Tabulator("#table2", {
        data: table2Data,
        autoColumns: true,
        layout: "fitColumns",
        height: "255px",
        pagination: "local",
        paginationSize: 5,
        paginationSizeSelector: [5, 10, 30, 50, true],
        movableColumns: true,
        resizableRows: true,
        tooltips: true,
        tooltipsHeader: true,
        tooltipGenerationMode: "hover",
        selectable: true,
        columns: [
            { title: "checkbox", field: "checkbox" },
            { title: "序號", field: "序號" },
            { title: "幣別", field: "幣別" },
            { title: "原幣金額", field: "原幣金額" },
            { title: "兌換損益", field: "兌換損益" },
            { title: "金額", field: "金額" },
            { title: "支付方式", field: "支付方式" },
            { title: "付款單位", field: "付款單位" },
            { title: "暫收序號", field: "暫收序號" },
            { title: "電匯銀行代號", field: "電匯銀行代號" },
            { title: "電匯銀行名稱", field: "電匯銀行名稱" },
            { title: "退回維護日", field: "退回維護日" },
            { title: "郵寄日", field: "郵寄日" },
            { title: "票據兌現日", field: "票據兌現日" },
            { title: "票據轉雜收日", field: "票據轉雜收日" },
            { title: "帳號/票號", field: "帳號票號" },
            { title: "郵匯費", field: "郵匯費" },
            { title: "支付對象ID", field: "支付對象ID" },
            { title: "支付對象", field: "支付對象" },
            { title: "地址", field: "地址" },
            { title: "無法清理之樣態", field: "無法清理之樣態" },
            { title: "銀行退回手續費", field: "銀行退回手續費" },
            { title: "付款行", field: "付款行" },
            { title: "付款帳號", field: "付款帳號" },
            { title: "更新日期", field: "更新日期" },
            { title: "建檔日期", field: "建檔日期" },
            { title: "操作人員", field: "操作人員" },
            { title: "新暫收號", field: "新暫收號" },
            { title: "新暫收日", field: "新暫收日" },
            { title: "新暫收序號", field: "新暫收序號" },
        ],
    });
    </script>
</html>